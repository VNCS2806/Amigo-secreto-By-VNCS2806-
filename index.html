<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üéÑ Amigo Secreto</title>
  <meta name="description" content="Sorteio online de amigo secreto, simples, seguro e funcionando em qualquer dispositivo, sem cadastro ou Firebase.">
  <style>
    body { margin: 0; font-family: Arial, sans-serif; background: radial-gradient(circle, #0b3d2e, #021a12); color: #fff; text-align: center; }
    .box { max-width: 420px; margin: 40px auto; background: rgba(0,0,0,0.35); padding: 25px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.6); }
    input, button { width: 100%; padding: 14px; margin-top: 12px; border-radius: 8px; border: none; font-size: 16px; }
    button { background: #b30000; color: white; cursor: pointer; }
    button:active { background: #8f0000; }
    .hidden { display: none; }
    ul { text-align: left; }
  </style>
</head>
<body>

<div class="box" id="loginBox">
  <h2>üéÑ Amigo Secreto</h2>
  <p>Digite seu nome</p>
  <input id="nomeInput" placeholder="Ex: Vini" />
  <button id="btnEntrar">Entrar</button>
</div>

<div class="box hidden" id="sorteioBox">
  <h2>üéÅ Seu amigo secreto √©:</h2>
  <h1 id="resultado"></h1>
</div>

<div class="box hidden" id="adminBox">
  <h2>üîê ADMIN</h2>
  <button id="btnReset">Resetar evento</button>
  <h3>Status do sorteio</h3>
  <ul id="lista"></ul>
</div>

<script>
const NOMES = ['Alan','Dani','Vini','Alani','Vanda','Geraldo','Lourdes','Andr√©','V√¢nia','C√°ssia','Anderson','Liz'];
const ADMIN = 'viniciusadm';

// Guarda quem j√° sorteou e quem tirou quem
let usuarios = {}; // { nome: tirou }

// normaliza o nome para compara√ß√µes
function normalizar(txt) { return txt.trim().toLowerCase(); }

// ENTRAR
function entrar() {
  const input = document.getElementById('nomeInput');
  const nomeDigitado = normalizar(input.value);
  if (!nomeDigitado) { alert('Digite seu nome'); return; }

  // ADMIN
  if (nomeDigitado === ADMIN) {
    document.getElementById('loginBox').classList.add('hidden');
    document.getElementById('adminBox').classList.remove('hidden');
    atualizarAdmin();
    return;
  }

  // valida nome
  const nomeOficial = NOMES.find(n => normalizar(n) === nomeDigitado);
  if (!nomeOficial) { alert('Nome n√£o reconhecido'); return; }

  // bloqueio global por nome
  if (usuarios[nomeOficial]) { alert('Esse nome j√° sorteou.'); return; }

  // op√ß√µes v√°lidas (n√£o sortear a si mesmo e nomes j√° sorteados)
  let opcoes = NOMES.filter(n => n !== nomeOficial && !Object.values(usuarios).includes(n));
  if (opcoes.length === 0) { alert('Erro no sorteio'); return; }

  const sorteado = opcoes[Math.floor(Math.random()*opcoes.length)];
  usuarios[nomeOficial] = sorteado;

  // mostra resultado
  document.getElementById('loginBox').classList.add('hidden');
  document.getElementById('sorteioBox').classList.remove('hidden');
  document.getElementById('resultado').innerText = sorteado;

  // atualiza admin se ele estiver logado
  atualizarAdmin();
}

// ATUALIZA LISTA DO ADMIN
function atualizarAdmin() {
  const lista = document.getElementById('lista');
  lista.innerHTML = '';
  if (Object.keys(usuarios).length === 0) { lista.innerHTML = '<li>Ningu√©m sorteou ainda</li>'; return; }
  for (let [nome, tirou] of Object.entries(usuarios)) {
    lista.innerHTML += `<li>${nome} ‚ûú ${tirou}</li>`;
  }
}

// RESETAR EVENTO
function resetar() {
  if (!confirm('Resetar TODO o evento?')) return;
  usuarios = {};
  document.getElementById('sorteioBox').classList.add('hidden');
  document.getElementById('loginBox').classList.remove('hidden');
  atualizarAdmin();
  alert('Evento resetado');
}

// BOT√ïES
document.getElementById('btnEntrar').addEventListener('click', entrar);
document.getElementById('btnEntrar').addEventListener('touchend', e=>{ e.preventDefault(); entrar(); }, {passive:false});
document.getElementById('btnReset').addEventListener('click', resetar);

</script>
</body>
</html>
